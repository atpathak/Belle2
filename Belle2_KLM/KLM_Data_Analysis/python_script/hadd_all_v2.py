#!/usr/bin/env python3
# -*- coding: utf-8 -*-

# Prerequisite (on kekcc): type
# source /cvmfs/belle.cern.ch/tools/b2setup release-02-01-00
#
#

import sys
import os
import subprocess
import datetime
from ROOT import Belle2, TH1F, TH2F, TCanvas, THistPainter, TPad
from optparse import Option, OptionValueError, OptionParser



#RUNAGAIN = ['r02909', 'r02906', 'r02905', 'r02904', 'r02903', 'r02899', 'r02898', 'r02808', 'r02804', 'r02803', 'r02802', 'r02786', 'r02785', 'r02783', 'r02762', 'r02761', 'r02758', 'r02756', 'r02750', 'r02747', 'r02744', 'r02743', 'r02742', 'r02739', 'r02738', 'r02672', 'r02671', 'r02661', 'r02659', 'r02658', 'r02656', 'r02655', 'r02654', 'r02653', 'r02652', 'r02648', 'r02647', 'r02643', 'r02641', 'r02640', 'r02639', 'r02638', 'r02637', 'r02636', 'r02635', 'r02634', 'r02633', 'r02630', 'r02628', 'r02627', 'r02625', 'r02624', 'r02622', 'r02621', 'r02618', 'r02616', 'r02615', 'r02614', 'r02612', 'r02610', 'r02609', 'r02608', 'r02607', 'r02606', 'r02605', 'r02600', 'r02599', 'r02595', 'r02594', 'r02593', 'r02592', 'r02588', 'r02586', 'r02585', 'r02584', 'r02581', 'r02580', 'r02578', 'r02575', 'r02569', 'r02568', 'r02567', 'r02564', 'r02563', 'r02561', 'r02560', 'r02559', 'r02556', 'r02552', 'r02550', 'r02549', 'r02547', 'r02546', 'r02526', 'r02525', 'r02523', 'r02432', 'r02431', 'r02430', 'r02427', 'r02423', 'r02422', 'r02281', 'r02273', 'r02269', 'r02267', 'r02266', 'r02265', 'r02261', 'r02259', 'r02254', 'r02253', 'r02251', 'r02249', 'r02244', 'r02243', 'r02242', 'r02241', 'r02240', 'r02239', 'r02233', 'r02229', 'r02228', 'r02222', 'r02214', 'r02213', 'r02209', 'r02205', 'r02201', 'r02200', 'r02199', 'r02198', 'r02197', 'r02196', 'r02193', 'r02192', 'r02191', 'r02190', 'r02189', 'r02186', 'r02184', 'r02181', 'r02175', 'r02174', 'r02173', 'r02170', 'r02169', 'r02165', 'r02163', 'r02153', 'r02152', 'r02151', 'r02148', 'r02147', 'r02139', 'r02138', 'r02137', 'r02135', 'r02134', 'r02085', 'r02084', 'r02082', 'r02080', 'r02076', 'r02075', 'r02074', 'r02073', 'r02070', 'r02068', 'r02067', 'r02066', 'r02063', 'r02062', 'r02048', 'r02045', 'r01996', 'r01994', 'r01987', 'r01986', 'r01985', 'r01981', 'r01980', 'r01978', 'r01977', 'r01976', 'r01973', 'r01972', 'r01971', 'r01970', 'r01968', 'r01966', 'r01964', 'r01960', 'r01959', 'r01958', 'r01953', 'r01951', 'r01948', 'r01946', 'r01942', 'r01940', 'r01936', 'r01935', 'r01932', 'r01926', 'r01925', 'r01920', 'r01917', 'r01835', 'r01834', 'r01833', 'r01828', 'r01826', 'r01821', 'r01819', 'r01818', 'r01817', 'r01816', 'r01815', 'r01814', 'r01812', 'r01808', 'r01807', 'r01802', 'r01801', 'r01800', 'r01799', 'r01797', 'r01791', 'r01790', 'r01789', 'r01778', 'r01777', 'r01770', 'r01738', 'r01737', 'r01731', 'r01726', 'r01720', 'r01715', 'r01707', 'r01704', 'r01703', 'r01551', 'r01550', 'r01544', 'r01541', 'r01540', 'r01539', 'r01538', 'r01534', 'r01529', 'r01528', 'r01527', 'r01526', 'r01525', 'r01524', 'r01519', 'r01419', 'r01418', 'r01336', 'r01335', 'r01334', 'r01333', 'r01332', 'r01331', 'r01329', 'r01328', 'r01327', 'r01325', 'r01324', 'r01323', 'r01322', 'r01316', 'r01315', 'r01309', 'r01308', 'r01307', 'r01306', 'r01296', 'r01295', 'r01293', 'r01292', 'r01291', 'r01289', 'r01288', 'r01287', 'r01275', 'r01266', 'r01265', 'r01263', 'r01262', 'r01248', 'r01242', 'r01240', 'r01239', 'r01238', 'r01237', 'r01235', 'r01233', 'r01230', 'r01229', 'r01228', 'r01226', 'r01221', 'r01217', 'r01216', 'r01215', 'r01213', 'r01212', 'r01208', 'r01207', 'r01204', 'r01202', 'r01201', 'r01175', 'r01174', 'r01172', 'r01171', 'r01170', 'r01168', 'r01165', 'r01163', 'r01161', 'r01158', 'r01150', 'r01145', 'r01144', 'r01143', 'r01137', 'r01136', 'r01135', 'r01131', 'r01126', 'r01123', 'r01122', 'r01109', 'r01105', 'r01104', 'r01103', 'r01096', 'r01094', 'r01093', 'r01092', 'r01070', 'r01068', 'r01065', 'r01064', 'r01061', 'r01060', 'r01059', 'r01058', 'r01055', 'r01054', 'r01053', 'r01050', 'r01039', 'r01038', 'r01037', 'r01036', 'r01031', 'r01030', 'r01029', 'r01027', 'r01026', 'r01025', 'r01020', 'r01010', 'r01008', 'r01006', 'r01005', 'r01001', 'r00849', 'r00848', 'r00847', 'r00846', 'r00845', 'r00843', 'r00840', 'r00839', 'r00838', 'r00836', 'r00834', 'r00833', 'r00831', 'r00791', 'r00790', 'r00788', 'r00787', 'r00786', 'r00784', 'r00660', 'r00659', 'r00654', 'r00569', 'r00554', 'r00377', 'r00372', 'r00369', 'r00367', 'r00364', 'r00363', 'r00361', 'r00357', 'r00352', 'r00351', 'r00349', 'r00348', 'r00347', 'r00345', 'r00344', 'r00343', 'r00341', 'r00340', 'r00339', 'r00332', 'r00328', 'r00305', 'r00303', 'r00301', 'r00300', 'r00296', 'r00295', 'r00287', 'r00282', 'r00280', 'r00278', 'r00277', 'r00276', 'r00245', 'r00244', 'r00240', 'r00238', 'r00237', 'r00236', 'r00235', 'r00230', 'r00228', 'r00226', 'r00225', 'r00223', 'r00221', 'r00220', 'r00219', 'r00218', 'r00217', 'r00214', 'r00213', 'r00212', 'r00211', 'r00194', 'r00193', 'r00191', 'r00190', 'r00189', 'r00185', 'r00184', 'r00183', 'r00182', 'r00181', 'r00179', 'r00173', 'r00156', 'r00133', 'r00132', 'r00128', 'r00127', 'r00126', 'r00125', 'r00124', 'r00122', 'r00120', 'r00117', 'r00059', 'r00056', 'r00054', 'r00053', 'r00052', 'r00051', 'r00050', 'r00048', 'r00047', 'r00045', 'r00043']
RUNAGAIN = ['r02934', 'r02935', 'r02939', 'r02940', 'r02941', 'r02942', 'r02943', 'r02944', 'r02945', 'r02949', 'r02950', 'r02951', 'r02952', 'r02953', 'r02954', 'r02970', 'r02971', 'r02972', 'r02973', 'r02974', 'r03041', 'r03042', 'r03043', 'r03044', 'r03045', 'r03046', 'r03047', 'r03048', 'r03052', 'r03053', 'r03054', 'r03055', 'r03056', 'r03057', 'r03058', 'r03059', 'r03071', 'r03074', 'r03075', 'r03076', 'r03077', 'r03078', 'r03080', 'r03085', 'r03087', 'r03088', 'r03089', 'r03090', 'r03091', 'r03092', 'r03115', 'r03118', 'r03121', 'r03123']
HLT = ["HLT1","HLT2","HLT3","HLT4","HLT5"]

def submitjobs(Location):
    #RunNameList = os.listdir(Location)
    infile2=open("hadd.sh","w")
    #Run = [i[2:] for i in RUNAGAIN]
    #run = [i[2:] for i in RUNAGAIN]
    for i in RUNAGAIN:
        HLT1Location = "/ghi/fs01/belle2/bdata/group/detector/BKLM/Run_Analysis/e0008/bklmroots/"+i+"/eklmHists-e0008"+i+"_HLT1.root"
        HLT2Location = "/ghi/fs01/belle2/bdata/group/detector/BKLM/Run_Analysis/e0008/bklmroots/"+i+"/eklmHists-e0008"+i+"_HLT2.root"
        HLT3Location = "/ghi/fs01/belle2/bdata/group/detector/BKLM/Run_Analysis/e0008/bklmroots/"+i+"/eklmHists-e0008"+i+"_HLT3.root"
        HLT4Location = "/ghi/fs01/belle2/bdata/group/detector/BKLM/Run_Analysis/e0008/bklmroots/"+i+"/eklmHists-e0008"+i+"_HLT4.root"
        HLT5Location = "/ghi/fs01/belle2/bdata/group/detector/BKLM/Run_Analysis/e0008/bklmroots/"+i+"/eklmHists-e0008"+i+"_HLT5.root"

        if os.path.exists(HLT1Location):
            L1 = HLT1Location
        else:
            L1 =''

        if os.path.exists(HLT2Location):
            L2 = HLT2Location
        else:
            L2 =''

        if os.path.exists(HLT3Location):
            L3 = HLT3Location
        else:
            L3 =''

        if os.path.exists(HLT4Location):
            L4 = HLT4Location
        else:
            L4 =''

        if os.path.exists(HLT5Location):
            L5 = HLT5Location
        else:
            L5 =''
        
        infile2.write("hadd /ghi/fs01/belle2/bdata/group/detector/BKLM/Run_Analysis/e0008/bklmroots/"+i+"/eklmHists-e0008"+i+".root " + L1+ " " +L2+ " " +L3+ " " +L4+ " " +L5+ " \n")

#=========================================================================
#
#   Main routine
#
#=========================================================================

parser = OptionParser()
parser.add_option('-e', '--experiment', dest='eNumber',
                  default='8',
                  help='Experiment number [default=7]')
parser.add_option('-r', '--run', dest='rNumber',
                  default='0133',
                  help='Run number [default=0604]')
(options, args) = parser.parse_args()
exp = '{0:04d}'.format(int(options.eNumber))
run = '{0:05d}'.format(int(options.rNumber))

RunLocation = "/ghi/fs01/belle2/bdata/Data/Raw/e{0}/".format(exp)
RunLocation = "."
submitjobs(RunLocation)
